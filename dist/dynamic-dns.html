
<!doctype html>
<html class="no-js" lang="en">
<head>
  <meta charset="utf-8">
<title>Audio, Electronics and Software</title>
<meta name="description" content="">


<!-- Twitter Cards -->
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://chinpen.net/blog/img/site-logo.png">
<meta name="twitter:title" content="Audio, Electronics and Software">
<meta name="twitter:description" content="">
<meta name="twitter:creator" content="@ntt">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Audio, Electronics and Software">
<meta property="og:description" content="">
<meta property="og:url" content="https://chinpen.net/blog/dynamic-dns.html">
<meta property="og:site_name" content="Audio, Electronics and Software">





<link rel="canonical" href="https://chinpen.net/blog/dynamic-dns.html">
<link href="https://chinpen.net/blog/feed.xml" type="application/atom+xml" rel="alternate" title="Audio, Electronics and Software Feed">


<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="/styles/index.css">
<!-- Webfonts -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:ital,wght@0,200..900;1,200..900&family=Volkhov:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">

<meta http-equiv="cleartype" content="on">

<link rel="shortcut icon" href="https://chinpen.net/blog/favicon.ico">
<link rel="shortcut icon" href="https://chinpen.net/blog/favicon.png">
  
</head>

<body id="page" class="border-t-5 border-solid border-stone-900">

  <div class="text-center">
	<nav role="navigation" class="animate-drop">
		<ul class="inline-flex gap-6 px-4 py-1 bg-black rounded-b-md text-white text-sm">
			
			<li class="text-xl">
				
				<a href="https://chinpen.net">Home</a>
				
			</li>
			
			<li class="text-xl">
				
				<a href="https://chinpen.net/blog/blog/">Blog</a>
				
			</li>
			
			<li class="text-xl">
				
				<a href="https://chinpen.net/blog/about/">About</a>
				
			</li>
			
			<li class="text-xl">
				
				<a href="https://chinpen.net/blog/feed.xml">Feed</a>
				
			</li>
			
		</ul>
	</nav>
</div>

  <header>
		<div class="max-w-3xl text-center mx-auto py-2">
			<a href="https://chinpen.net/blog/" class="site-logo" rel="home" title="Audio, Electronics and Software">
                <span class="icon-[tabler--headphones-filled] h-30 w-30"></span>
            </a>
		</div>
        <h1 class="text-4xl text-center font-bold font-sans"><a href="https://chinpen.net/blog/">Audio, Electronics and Software</a></h1>
</header>

  <div>
    <article>
      <div class="max-w-5xl mx-auto pt-8">
        <header>
          <h1 class="text-7xl font-['serif'] italic tracking-tight mb-6 mt-6">Dynamic DNS</h1>
        </header>
        <div class="flex">
          <div class="px-4 flex flex-col gap-2">
            <picture><source type="image/webp" srcset="/.11ty/image/?src=https%3A%2F%2Fchinpen.net%2Fblog%2Fimages%2Fchinpen.jpg&width=180&format=webp&via=transform 180w"><img src="/.11ty/image/?src=https%3A%2F%2Fchinpen.net%2Fblog%2Fimages%2Fchinpen.jpg&width=180&format=jpeg&via=transform" alt="Chinmay photo" class="rounded-full" width="180" height="180"></picture>
            <span class="border-b-1 border-stone-200">
                By <a href="https://chinpen.net/blog/about/" title="About Chinmay">Chinmay</a>
            </span>
            
            <span class="border-b-1 border-stone-200">
              <time datetime="2016-10-26T08:00:00+08:00">
                <i class="icon-calendar-empty"></i> October 26, 2016
              </time>
            </span>
            
            <span class="border-b-1 border-stone-200">
              <a href="https://chinpen.net/blog/dynamic-dns.html" rel="bookmark" title="">
                <i class="icon-link"></i> Permalink
              </a>
            </span>
          </div>
          <div class="flex-1">
            <div class="w-full text-xl content">
              <p>I run a small headless Linux server at home. It has come in handy for running a VPN server, IRC bouncer, downloading server and other quick trick and hacks. Since I rarely need it to do any significant computation, I run it on an old <a href="https://www.raspberrypi.org/">Raspberry Pi</a> (the original one).</p>
<p>One of the question I always get is how I manage to access the server from outside. While static IP addresses are an option for many telcos in Singapore, mine doesn't provide that service for an affordable price, so I decided to roll my own <a href="https://en.wikipedia.org/wiki/Dynamic_DNS">Dynamic DNS</a> system to let me access this server from outside the home network.</p>
<h2>Logging the IP address</h2>
<p>I first started to experiment by logging the IP address assigned to the edge router by the ISP every 5 minutes. It was a simple <code>curl</code> script on a <code>cron</code> job that checked an online public IP service like <a href="https://www.ipify.org/">ipify</a> or <a href="https://diagnostic.opendns.com/myip">OpenDNS</a> and logged it to a file.</p>
<p><code>{ date ; echo &quot; - &quot;; curl -s 'https://api.ipify.org?format=text'\;} | tr &quot;\n&quot; &quot; &quot;</code></p>
<p>With this I was able to see that my ISP didn't change the IP addresses assigned to me for months. That means this DIY Dynamic DNS system would work without too much down time.</p>
<pre class="shiki snazzy-light" style="background-color:#FAFBFC;color:#565869" tabindex="0"><code class="language-text"><span class="line"><span>Tue Oct 26 09:00:07 SGT 2015  -  210.23.20.192</span></span>
<span class="line"><span>Tue Oct 26 10:00:06 SGT 2015  -  210.23.20.192</span></span>
<span class="line"><span>Tue Oct 26 11:00:05 SGT 2015  -  210.23.20.192</span></span>
<span class="line"><span>...</span></span>
<span class="line"><span>Sun Nov 22 11:00:07 SGT 2015  -  210.23.20.192</span></span>
<span class="line"><span>Sun Nov 22 11:00:06 SGT 2015  -  210.23.20.192</span></span>
<span class="line"><span>Sun Nov 22 11:00:06 SGT 2015  -  210.23.20.192</span></span></code></pre>
<h2>Updating DNS records</h2>
<p>There are online service like <a href="https://dyn.com/dns/">DynDNS</a> but I found them too clunky to use. But I did figure that Cloudflare (whom I use for DNS anyway) also support <a href="https://api.cloudflare.com/#dns-records-for-a-zone-update-dns-record">updating DNS records over an API call</a>.</p>
<p>So the basic idea would be to fetch the IP address assigned to the edge router by the ISP and send it to Cloudflare periodically. I found that <a href="https://sourceforge.net/p/ddclient/wiki/Home/">ddclient</a> is a Perl script written to do exactly this. It runs as a daemon, periodically fetches the local IP address, check if it is the same one as previously sent to the DNS server otherwise updates the DNS server.</p>
<p>You can install <code>ddclient</code> with your favorite package manager. For eg. on Ubuntu/Debian :</p>
<p><code>sudo apt-get install ddclient</code></p>
<p>Newer version of <code>ddclient</code> work directly with Cloudflare, but older versions need a small patch. This <a href="https://jenssegers.com/84/dynamic-dns-for-cloudflare-with-ddclient">post from Jens Segers explains it </a> well.</p>
<p><code>ddclient</code> has a config file <code>ddclient.conf</code> usually located in <code>/etc</code> that allows you to configure it</p>
<p>You have to provide <code>ddclient</code> a script to get the local IP address. I use OpenDNS like this :</p>
<p><code>dig +short myip.opendns.com @resolver1.opendns.com</code></p>
<p>Here is an example of the <code>ddclient.conf</code> for my setup. <code>getIP.sh</code> basically runs the <code>dig</code> command above.</p>
<pre class="shiki snazzy-light" style="background-color:#FAFBFC;color:#565869" tabindex="0"><code class="language-text"><span class="line"><span>daemon=300</span></span>
<span class="line"><span>pid=/var/run/ddclient.pid</span></span>
<span class="line"><span>ssl=yes                                                   \</span></span>
<span class="line"><span>use=cmd, cmd=getIP.sh                                     \</span></span>
<span class="line"><span>protocol=cloudflare,                                      \</span></span>
<span class="line"><span>zone=chinpen.net,                                         \</span></span>
<span class="line"><span>login=login@email.com,                                    \</span></span>
<span class="line"><span>password=password                                         \</span></span>
<span class="line"><span>dynamic.chinpen.net</span></span></code></pre>
<p>On the Cloudflare side, I created an A record, which pointed the desired URL (dynamic.chinpen.net) to the the local IP address. This record would then get automatically updated by <code>ddclient</code> when it sees the local IP address changing.</p>
<p><picture><source type="image/webp" srcset="/.11ty/image/?src=src%2Fimg%2F2016%2F10%2Fdns.jpg&width=1942&format=webp&via=transform 1942w"><img src="/.11ty/image/?src=src%2Fimg%2F2016%2F10%2Fdns.jpg&width=1942&format=jpeg&via=transform" alt="" width="1942" height="126"></picture></p>
<h2>Running ddclient</h2>
<p>I run <code>ddclient</code> on the Raspberry Pi itself, but you could always run it on any linux box. In fact that's another great use for an old Raspberry Pi.</p>
<p>The main reason this technique works for me is that I don't really need very very high availability. With this current setup there is a possibility the server would be unaccessible for five minutes (300 seconds) in the worst case scenario, and that's a chance I am comfortable with.</p>

            </div>
            
          </div>
        </div>
      </div>
      <nav class="pagination" role="navigation">
        
        
      </nav><!-- /.pagination -->
    </article>
  </div><!-- /#main -->

  <footer class="my-[2em] mx-auto text-center border-t border-stone-200 pt-4" role="contentinfo">
	<nav>
		<h5 class="font-[volkhov] text-sm italic text-stone-500"><em>&copy; 2026 Chinmay. Powered by <a href="https://www.eleventy.dev/" target="_blank">Eleventy</a></em>.
		<div class="grid grid-flow-col justify-center gap-4">
			<a href="https://twitter.com/ntt" title="Chinmay on Twitter" target="_blank">
				<span class="icon-[tabler--brand-twitter-filled]" style="width: 48px; height: 48px; color: var(--color-stone-700);"></span>
			</a>
			<a href="https://github.com/notthetup" title="Chinmay on Github" target="_blank">
				<span class="icon-[tabler--brand-github-filled]" style="width: 48px; height: 48px; color: var(--color-stone-700);"></span>
			</a>
		</div>
	</h5></nav>
</footer>


</body>
</html>
