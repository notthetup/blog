---
layout: post
title: 'RaspberryPi Soundboard – Update #3'
categories:
- Audio
- Dev
tags: []
status: publish
type: post
published: true
meta:
  _edit_last: '1'
  _wpas_done_all: '1'
  _wp-svbtle-kudos: '1'
author:
  login: chinpen
  email: chinpen@chinpen.net
  display_name: chinpen
  first_name: Chin
  last_name: Pen
---
<p>Finally found more time to spend on the <a href="http://wp.me/pJdWn-Zj">RaspberryPi Soundboard Project</a>.</p>
<p>After mucking around for days with <a href="http://pulseaudio.org/wiki/">Pulseaudio</a>, and getting significantly annoyed at being able to do a simple loopback or virtual device functionality, I tried <a href="http://jackaudio.org/documentation">Jack</a>.</p>
<p>Jack is perfect for <a href="http://qjackctl.sourceforge.net/qjackctl-ss1.html">such 'piping'</a>, but I figured out the hard way that there is <a href="http://sourceforge.net/p/mumble/patches/324/">no official Mumble support for Jack</a>.</p>
<p>Thankfully I found out about ALSA's <a href="http://www.alsa-project.org/main/index.php/Matrix:Module-aloop">snd_aloop module</a>. This creates <a href="http://plasmasturm.org/log/soundserverhack/">a 'virtual card' with 2 device</a>s. If you play audio into one, it comes out of the other. Exactly what I needed, and Mumble does query all the ALSA devices, so I can easily find my 'Loopback' device.</p>
<p style="text-align: center;"><img class="aligncenter  wp-image-3818" style="text-align: center;" alt="mumble" src="http://chinpen.net/blog/wp-content/uploads/2014/04/IMG_20140413_220131-1024x559.jpg" width="491" height="268" /></p>
<p>Next was playing the audio. Using simple '<a href="http://alsa.opensrc.org/Aplay">aplay</a>', I could test if my setup was working. But to have better control over the audio (fade-in, fade-out), I would need a more programmatic approach.</p>
<p>Since we're on a RaspberryPi, Python is a natural choice, although since I am using Archlinux, Python doesn't come installed!. So I installed <a href="http://archlinuxarm.org/packages">Python2</a> and found <a href="http://www.pygame.org/news.html">pygame</a>, a wrapper around <a href="http://www.libsdl.org/">libSDL</a> which has a nice <a href="http://www.pygame.org/docs/ref/mixer.html">mixer and audio module</a>. It's surely an overkill for what I'm trying to do. But I do need something that lets me choose which ALSA device to use (with pygame <a href="http://www.libsdl.org/release/SDL-1.2.15/docs/html/sdlenvvars.html">I can define that using environment variables which SDL uses</a>), and something which lets me do basic audio effects like mixing, fading etc.</p>
<p>So this works for now. Although the audio from Mumble is pretty glitchy, I think some Mumble settings need to be tweaked. But I am still worried that running the Mumble GUI is making the Pi slow. I may have to figure out a way<span style="line-height: 1.5em;"> to run Mumble headless.</span></p>
